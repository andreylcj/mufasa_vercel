{"ast":null,"code":"import jwt from 'jsonwebtoken';\nimport Users from '../models/UserModel';\n\nconst auth = async (req, res) => {\n  const token = req.headers.authorization;\n  if (!token) return res.status(400).json({\n    err: 'Autenticação inválida: Não existe token'\n  });\n  console.log(req.headers.authorization);\n  const decoded = jwt.verify(token, process.env.ACCESS_TOKEN_SECRET);\n  if (!decoded) return res.status(400).json({\n    err: 'Autenticação inválida: Token inválido'\n  });\n  console.log(decoded);\n  const user = await Users.findOne({\n    _id: decoded.id\n  });\n  return user;\n};\n\nexport default auth;","map":{"version":3,"sources":["C:/Users/Andrey luiz/Desktop/MUFASA/mufasa_vercel/assets/middleware/auth.js"],"names":["jwt","Users","auth","req","res","token","headers","authorization","status","json","err","console","log","decoded","verify","process","env","ACCESS_TOKEN_SECRET","user","findOne","_id","id"],"mappings":"AAAA,OAAOA,GAAP,MAAgB,cAAhB;AACA,OAAOC,KAAP,MAAkB,qBAAlB;;AAEA,MAAMC,IAAI,GAAG,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;AAE7B,QAAMC,KAAK,GAAGF,GAAG,CAACG,OAAJ,CAAYC,aAA1B;AACA,MAAI,CAACF,KAAL,EAAY,OAAOD,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,IAAAA,GAAG,EAAE;AAAP,GAArB,CAAP;AACZC,EAAAA,OAAO,CAACC,GAAR,CAAYT,GAAG,CAACG,OAAJ,CAAYC,aAAxB;AACA,QAAMM,OAAO,GAAGb,GAAG,CAACc,MAAJ,CAAWT,KAAX,EAAkBU,OAAO,CAACC,GAAR,CAAYC,mBAA9B,CAAhB;AACA,MAAI,CAACJ,OAAL,EAAc,OAAOT,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,IAAAA,GAAG,EAAE;AAAP,GAArB,CAAP;AACdC,EAAAA,OAAO,CAACC,GAAR,CAAYC,OAAZ;AAEA,QAAMK,IAAI,GAAG,MAAMjB,KAAK,CAACkB,OAAN,CAAc;AAAEC,IAAAA,GAAG,EAAEP,OAAO,CAACQ;AAAf,GAAd,CAAnB;AAEA,SAAOH,IAAP;AAEH,CAbD;;AAeA,eAAehB,IAAf","sourcesContent":["import jwt from 'jsonwebtoken'\r\nimport Users from '../models/UserModel'\r\n\r\nconst auth = async (req, res) => {\r\n\r\n    const token = req.headers.authorization\r\n    if (!token) return res.status(400).json({ err: 'Autenticação inválida: Não existe token' })\r\n    console.log(req.headers.authorization)\r\n    const decoded = jwt.verify(token, process.env.ACCESS_TOKEN_SECRET)\r\n    if (!decoded) return res.status(400).json({ err: 'Autenticação inválida: Token inválido' })\r\n    console.log(decoded)\r\n\r\n    const user = await Users.findOne({ _id: decoded.id })\r\n\r\n    return user\r\n\r\n}\r\n\r\nexport default auth"]},"metadata":{},"sourceType":"module"}